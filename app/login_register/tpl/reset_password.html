<div class="">
    <div class="block-space block-space--layout--after-header"></div>
    <div class="block">
        <div class="container container--max--lg">
            <div class="row">
                <div class="col-md-12 d-flex">
                    <div class="card flex-grow-1 mb-md-0 mr-0 mr-lg-3 ml-0 ml-lg-4">
                        <div class="card-body card-body--padding--2">
                            <h3 class="card-title"><lang id='RESET_PASSWORD_L1'>Reset password</lang></h3>
                            <form id="reset_form">
                                <input type="hidden" name="code" value={CODE}>
                                <div class="form-group">
                                    <label for="signup-password"><lang id='HOME_LOGIN_L13'>Password</lang></label>
                                    <input id="signup-password" type="password" name="password" class="form-control passwordFp"
                                        placeholder="<lang id='HOME_LOGIN_L13'>Password</lang>">
                                </div>
                                <div class="form-group">
                                    <label for="signup-confirm"><lang id='HOME_LOGIN_L14'>Repeat password</lang></label>
                                    <input id="signup-confirm" type="password" name="password_again"
                                        class="form-control" placeholder="<lang id='HOME_LOGIN_L14'>Repeat password</lang>">
                                </div>
                                
                                <div class="form-group mb-0">
                                    <button type="submit"
                                        class="btn btn-primary mt-3"><lang id='RESET_PASSWORD_L2'>Save new password</lang></button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>                
            </div>
        </div>
    </div>
    <div class="block-space block-space--layout--before-footer"></div>
</div>


<script>

$("#reset_form").validate({
    submitHandler: function(form) {
        $.ajax({
            url: '<?php echo $this->urlFor("ajax/login_register/password_reset") ?>',
            type: 'POST',
            data: $("#reset_form").serialize(),
            beforeSend: function() {
                preloader.on();
            },
            success: function(data){
                preloader.off();
                if(data.success){
                    swal.fire({icon: 'success', text: '<lang id="RESET_PASSWORD_L2">Password changed successfully, now you can login to your account</lang>'});
                    window.location.href = "<?php echo $this->urlFor('index') ?>"
                } else {
                    swal.fire('Error (Code: ' + data.error + ')');
                }
            }
        });
    },
    rules: {
        password: {
            minlength: 8,
            password: true,
            required: true,
        },
        password_again: {
            minlength: 8,
            password: true,
            required: true,
            equalTo: '.passwordFp'
        },
    },
});


</script>